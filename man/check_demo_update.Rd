% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/demo_cache.R
\name{check_demo_update}
\alias{check_demo_update}
\title{Check Whether a Cached Demo File Needs Re-downloading}
\usage{
check_demo_update(url, cached_file_path, verbose = TRUE)
}
\arguments{
\item{url}{Character string with the remote URL of the file.}

\item{cached_file_path}{Character string with the local path to the
cached file.}

\item{verbose}{Logical whether to log status messages. Default
\code{TRUE}.}
}
\value{
A list with components:
\describe{
\item{needs_update}{Logical indicating if a re-download is needed.}
\item{reason}{Character string describing the decision:
\code{"not_cached"}, \code{"server_newer"},
\code{"up_to_date"}, \code{"age_exceeded"}, or
\code{"within_age_limit"}.}
}
}
\description{
Determines if a locally cached file should be refreshed by comparing
the server's \code{Last-Modified} header (via \code{http_head_demo()})
with the file's modification time. When the HEAD request fails or the
server does not provide a \code{Last-Modified} header, the function
falls back to an age-based check using
\code{get_istat_config()$demo$cache_max_age_days}.
}
\examples{
\dontrun{
status <- check_demo_update(
  url = "https://demo.istat.it/data/d7b/D7B2024.csv.zip",
  cached_file_path = "demo_data/d7b/D7B2024.csv.zip"
)
if (status$needs_update) message("Re-download required: ", status$reason)
}

}
\keyword{internal}
