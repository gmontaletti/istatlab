<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>CLAUDE.md ‚Ä¢ istatlab</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="CLAUDE.md"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">istatlab</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="articles/getting-started.html">Get Started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>English</h6></li>
    <li><a class="dropdown-item" href="articles/getting-started.html">Getting Started</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Italiano</h6></li>
    <li><a class="dropdown-item" href="articles/getting-started-it.html">Introduzione a istatlab</a></li>
    <li><a class="dropdown-item" href="articles/api-istat-sdmx-it.html">API ISTAT SDMX: guida completa</a></li>
    <li><a class="dropdown-item" href="articles/gestione-dati-it.html">Gestione efficiente dei dati</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gmontaletti/istatlab" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>CLAUDE.md</h1>
      <small class="dont-index">Source: <a href="https://github.com/gmontaletti/istatlab/blob/main/CLAUDE.md" class="external-link"><code>CLAUDE.md</code></a></small>
    </div>


<div id="claudemd" class="section level1">

<p>This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.</p>
<div class="section level2">
<h2 id="project-overview">Project Overview<a class="anchor" aria-label="anchor" href="#project-overview"></a></h2>
<p><strong>istatlab</strong> is an R package for downloading, processing, analyzing, and visualizing Italian labour market data from ISTAT‚Äôs SDMX API. The package is authored by Giampaolo Montaletti (<a href="mailto:giampaolo.montaletti@gmail.com" class="email">giampaolo.montaletti@gmail.com</a>, GitHub: gmontaletti).</p>
</div>
<div class="section level2">
<h2 id="package-structure">Package Structure<a class="anchor" aria-label="anchor" href="#package-structure"></a></h2>
<p>This is a standard R package with the following core structure:</p>
<ul><li>
<code>R/</code>: Main source code organized by functionality
<ul><li>
<code>download.R</code>: API data retrieval functions</li>
<li>
<code>metadata.R</code>: Metadata management and caching</li>
<li>
<code>processing.R</code>: Data processing and labeling functions</li>
<li>
<code>analysis.R</code>: Time series analysis and trend detection</li>
<li>
<code>forecast.R</code>: Forecasting methods (ARIMA, ETS, linear, naive)</li>
<li>
<code>visualize.R</code>: ggplot2-based visualization functions</li>
</ul></li>
<li>
<code>tests/testthat/</code>: Test suite using testthat framework</li>
<li>
<code>man/</code>: Auto-generated documentation from roxygen2 comments</li>
<li>
<code>data-raw/</code>: Raw data processing scripts</li>
<li>
<code>vignettes/</code>: Package vignettes and tutorials</li>
</ul></div>
<div class="section level2">
<h2 id="development-commands">Development Commands<a class="anchor" aria-label="anchor" href="#development-commands"></a></h2>
<div class="section level3">
<h3 id="building-and-checking">Building and Checking<a class="anchor" aria-label="anchor" href="#building-and-checking"></a></h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load package for development</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">load_all</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check package</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">check</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build package</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">build</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install package</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a></h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run all tests</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">test</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run specific test file</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_file.html" class="external-link">test_file</a></span><span class="op">(</span><span class="st">"tests/testthat/test-download.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test coverage</span></span>
<span><span class="fu">covr</span><span class="fu">::</span><span class="fu">package_coverage</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="external-test-workflow">External Test Workflow<a class="anchor" aria-label="anchor" href="#external-test-workflow"></a></h3>
<p>The test workflow directory is located at: <code>/Users/giampaolomontaletti/Documents/funzioni/test/istatlab_test</code></p>
<p>Use this directory for integration testing and workflow validation outside the package structure.</p>
</div>
<div class="section level3">
<h3 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a></h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate documentation from roxygen2 comments</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">document</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build vignettes</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">build_vignettes</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check examples</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">run_examples</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="code-architecture">Code Architecture<a class="anchor" aria-label="anchor" href="#code-architecture"></a></h2>
<div class="section level3">
<h3 id="core-dependencies">Core Dependencies<a class="anchor" aria-label="anchor" href="#core-dependencies"></a></h3>
<ul><li>
<strong>data.table</strong>: Primary data manipulation framework for performance</li>
<li>
<strong>readsdmx</strong>: SDMX API integration for ISTAT data</li>
<li>
<strong>ggplot2</strong>: All visualization functions</li>
<li>
<strong>zoo</strong>: Time series data handling</li>
<li>
<strong>forecast</strong>: Advanced forecasting methods</li>
</ul></div>
<div class="section level3">
<h3 id="data-flow-pattern">Data Flow Pattern<a class="anchor" aria-label="anchor" href="#data-flow-pattern"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>Download</strong>: Raw SDMX data retrieval with error handling and retries</li>
<li>
<strong>Metadata</strong>: Cached metadata management (14-day refresh cycle)</li>
<li>
<strong>Processing</strong>: Label application and data validation</li>
<li>
<strong>Analysis</strong>: Time series analysis, growth rates, structural breaks</li>
<li>
<strong>Forecasting</strong>: Multiple forecasting methods with accuracy evaluation</li>
<li>
<strong>Visualization</strong>: Publication-ready plots with consistent theming</li>
</ol></div>
<div class="section level3">
<h3 id="key-design-principles">Key Design Principles<a class="anchor" aria-label="anchor" href="#key-design-principles"></a></h3>
<ul><li>All functions use data.table for performance on large datasets</li>
<li>Comprehensive input validation with informative error messages</li>
<li>Metadata caching to minimize API calls</li>
<li>Consistent roxygen2 documentation with examples</li>
<li>Error handling with graceful fallbacks throughout</li>
</ul></div>
<div class="section level3">
<h3 id="important-notes">Important Notes<a class="anchor" aria-label="anchor" href="#important-notes"></a></h3>
<ul><li>
<strong>NEVER modify the original <code>moneca()</code> function</strong> (mentioned in global instructions)</li>
<li>Functions are designed for Italian labour market data but architecture supports extension</li>
<li>API connectivity checking is built into download functions</li>
<li>Time series functions handle both quarterly and monthly data automatically</li>
</ul></div>
<div class="section level3">
<h3 id="testing-strategy">Testing Strategy<a class="anchor" aria-label="anchor" href="#testing-strategy"></a></h3>
<ul><li>Unit tests for all major functions</li>
<li>API connectivity tests (with appropriate mocking)</li>
<li>Data validation tests</li>
<li>Forecast accuracy validation</li>
<li>Plot generation tests (using vdiffr for visual regression)</li>
</ul></div>
<div class="section level3">
<h3 id="common-dataset-ids-for-testingexamples">Common Dataset IDs (for testing/examples)<a class="anchor" aria-label="anchor" href="#common-dataset-ids-for-testingexamples"></a></h3>
<ul><li>
<code>150_908</code>: Monthly employment data</li>
<li>
<code>150_915</code>: Quarterly employment statistics<br></li>
<li>
<code>151_914</code>: Unemployment rates</li>
<li>
<code>534_50</code>: Job vacancies</li>
</ul></div>
</div>
<div class="section level2">
<h2 id="version-management-workflow">Version Management Workflow<a class="anchor" aria-label="anchor" href="#version-management-workflow"></a></h2>
<div class="section level3">
<h3 id="semantic-versioning">Semantic Versioning<a class="anchor" aria-label="anchor" href="#semantic-versioning"></a></h3>
<p>The istatlab package follows semantic versioning (SemVer) with the format MAJOR.MINOR.PATCH: - <strong>MAJOR</strong>: Incompatible API changes - <strong>MINOR</strong>: New functionality in a backwards compatible manner - <strong>PATCH</strong>: Backwards compatible bug fixes</p>
</div>
<div class="section level3">
<h3 id="git-and-renv-integration">Git and renv Integration<a class="anchor" aria-label="anchor" href="#git-and-renv-integration"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>Before making changes</strong>: Always check <code><a href="https://rstudio.github.io/renv/reference/status.html" class="external-link">renv::status()</a></code> and <code>git status</code>
</li>
<li>
<strong>After adding new dependencies</strong>: Run <code><a href="https://rstudio.github.io/renv/reference/snapshot.html" class="external-link">renv::snapshot()</a></code> to update renv.lock</li>
<li>
<strong>Before commits</strong>: Ensure all tests pass with <code>devtools::check()</code>
</li>
<li>
<strong>Commit workflow</strong>:
<ul><li>Use conventional commit format: <code>type(scope): description</code>
</li>
<li>Common types: feat, fix, docs, style, refactor, test, chore</li>
<li>Always commit renv.lock when dependencies change</li>
</ul></li>
</ol></div>
<div class="section level3">
<h3 id="version-release-process">Version Release Process<a class="anchor" aria-label="anchor" href="#version-release-process"></a></h3>
<ol style="list-style-type: decimal"><li>Update version number in DESCRIPTION file</li>
<li>Update Date field in DESCRIPTION to release date</li>
<li>Add release notes to NEWS.md</li>
<li>Run <code>devtools::check()</code> to ensure package integrity</li>
<li>Run <code><a href="https://rstudio.github.io/renv/reference/snapshot.html" class="external-link">renv::snapshot()</a></code> if dependencies changed</li>
<li>Commit changes with message: <code>chore: release version X.Y.Z</code>
</li>
<li>Create git tag: <code>git tag -a vX.Y.Z -m "Release version X.Y.Z"</code>
</li>
<li>Push commits and tags to GitHub</li>
</ol></div>
<div class="section level3">
<h3 id="file-management">File Management<a class="anchor" aria-label="anchor" href="#file-management"></a></h3>
<ul><li>
<strong>Never commit</strong>: renv/library/, renv/local/, renv/cellar/, .Rhistory</li>
<li>
<strong>Always commit</strong>: DESCRIPTION, NEWS.md, renv.lock (when changed), all R/ files</li>
<li>
<strong>Selectively commit</strong>: Documentation updates in man/ (auto-generated from roxygen2)</li>
</ul></div>
<div class="section level3">
<h3 id="branch-strategy">Branch Strategy<a class="anchor" aria-label="anchor" href="#branch-strategy"></a></h3>
<ul><li>
<strong>main</strong>: Stable releases only</li>
<li>
<strong>develop</strong>: Integration of new features</li>
<li>
<strong>feature/</strong>*: Individual feature development</li>
<li>
<strong>hotfix/</strong>*: Critical bug fixes for production</li>
</ul></div>
<div class="section level3">
<h3 id="pre-commit-checklist">Pre-commit Checklist<a class="anchor" aria-label="anchor" href="#pre-commit-checklist"></a></h3>
<ul><li><label><input type="checkbox">Package builds successfully (<code>devtools::build()</code>)</label></li>
<li><label><input type="checkbox">All tests pass (<code>devtools::test()</code>)</label></li>
<li><label><input type="checkbox">Documentation is current (<code>devtools::document()</code>)</label></li>
<li><label><input type="checkbox">renv is synchronized (<code><a href="https://rstudio.github.io/renv/reference/status.html" class="external-link">renv::status()</a></code>)</label></li>
<li><label><input type="checkbox">NEWS.md is updated for user-facing changes</label></li>
<li><label><input type="checkbox">Version number updated if needed</label></li>
<li>always use agents</li>
<li><h2 id="use-agents-for-tasks">use agents for tasks</h2></li>
</ul></div>
</div>
</div>
<div class="section level1">
<h1 id="super-claude-kit-integration">Super Claude Kit Integration<a class="anchor" aria-label="anchor" href="#super-claude-kit-integration"></a></h1>
<p>This project uses <strong>Super Claude Kit</strong> - a persistent context memory system for Claude Code that enables cross-message and cross-session memory.</p>
<div class="section level2">
<h2 id="id_-requirements">üìã Requirements<a class="anchor" aria-label="anchor" href="#id_-requirements"></a></h2>
<ul><li>
<strong>Git</strong>: Required for capsule and session tracking</li>
<li>
<strong>Python 3</strong>: Required for manifest parsing and hooks</li>
<li>
<strong>Go 1.20+</strong>: Required for building dependency tools (optional but recommended)
<ul><li>
<code>dependency-scanner</code>: Analyze code dependencies and relationships</li>
<li>
<code>progressive-reader</code>: Read large files efficiently with tree-sitter parsing</li>
<li>Install from: <a href="https://go.dev/dl/" class="external-link uri">https://go.dev/dl/</a>
</li>
</ul></li>
</ul><p><strong>Note</strong>: The kit works without Go, but dependency analysis tools will not be available.</p>
</div>
<div class="section level2">
<h2 id="id_-system-overview">üéØ System Overview<a class="anchor" aria-label="anchor" href="#id_-system-overview"></a></h2>
<p>Super Claude Kit provides: - <strong>Persistent Context</strong>: Remember files accessed, tasks worked on, and discoveries made - <strong>Smart Refresh</strong>: Automatic context updates before each prompt - <strong>Cross-Session Memory</strong>: Context persists across sessions (24-hour window) - <strong>Sub-Agent Tracking</strong>: Remember findings from specialized agents - <strong>Discovery Logging</strong>: Capture architectural insights and patterns</p>
</div>
<div class="section level2">
<h2 id="id_-usage-guide">üìñ Usage Guide<a class="anchor" aria-label="anchor" href="#id_-usage-guide"></a></h2>
<p><strong>CRITICAL</strong>: Read and follow <code>.claude/docs/CAPSULE_USAGE_GUIDE.md</code></p>
</div>
<div class="section level2">
<h2 id="id_-production-safety">üîí Production Safety<a class="anchor" aria-label="anchor" href="#id_-production-safety"></a></h2>
<p>Super Claude Kit is designed for safe production use:</p>
<p><strong>Sub-Agents (Read-Only):</strong> All 4 built-in sub-agents (architecture-explorer, database-navigator, agent-developer, github-issue-tracker) are <strong>read-only</strong>. They can analyze and explore code but cannot modify files or execute destructive operations.</p>
<p><strong>‚úÖ Sub-agents CAN:</strong> - Read files (Read tool) - Search code (Grep tool) - Find files (Glob tool) - Fetch web content (WebFetch - architecture-explorer only)</p>
<p><strong>‚ùå Sub-agents CANNOT:</strong> - Execute bash commands (Bash tool removed) - Modify files (no Edit/Write tools) - Delete files or run destructive operations</p>
<p>This design prevents accidental file modifications while maintaining full analytical capabilities.</p>
<div class="section level3">
<h3 id="required-behavior">Required Behavior<a class="anchor" aria-label="anchor" href="#required-behavior"></a></h3>
<p>Claude (you!) MUST follow these patterns:</p>
<div class="section level4">
<h4 id="id_1-check-capsule-before-redundant-operations">1. Check Capsule Before Redundant Operations<a class="anchor" aria-label="anchor" href="#id_1-check-capsule-before-redundant-operations"></a></h4>
<pre><code>BEFORE re-reading a file ‚Üí Check if it's in capsule (Files in Context)
BEFORE running git status ‚Üí Check capsule (Git State)
BEFORE asking about current task ‚Üí Check capsule (Current Tasks)</code></pre>
</div>
<div class="section level4">
<h4 id="id_2-logging-mostly-automatic">2. Logging (Mostly Automatic)<a class="anchor" aria-label="anchor" href="#id_2-logging-mostly-automatic"></a></h4>
<p><strong>AUTO-LOGGED (PostToolUse Hook):</strong> The following are logged automatically - you don‚Äôt need to call these manually: - Read/Edit/Write operations ‚Üí Logged to session_files.log automatically - Task tool (sub-agents) ‚Üí Logged to session_subagents.log automatically - TodoWrite updates ‚Üí Logged to session_tasks.log automatically</p>
<p><strong>MANUAL LOGGING REQUIRED (Discoveries Only):</strong> You must manually log discoveries - you decide what‚Äôs important:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">./.claude/hooks/log-discovery.sh</span> <span class="st">"&lt;category&gt;"</span> <span class="st">"&lt;insight&gt;"</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co"># Categories: pattern, insight, decision, architecture, bug, optimization, achievement</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># Examples:</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="ex">./.claude/hooks/log-discovery.sh</span> <span class="st">"pattern"</span> <span class="st">"All hooks use set -euo pipefail"</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="ex">./.claude/hooks/log-discovery.sh</span> <span class="st">"architecture"</span> <span class="st">"System uses microservices"</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="ex">./.claude/hooks/log-discovery.sh</span> <span class="st">"decision"</span> <span class="st">"Using PostgreSQL for storage"</span></span></code></pre></div>
<p><strong>OPTIONAL MANUAL LOGGING:</strong> Only needed if PostToolUse hook is disabled:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># File access (automatic via PostToolUse)</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="ex">./.claude/hooks/log-file-access.sh</span> <span class="st">"&lt;path&gt;"</span> <span class="st">"read|edit|write"</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># Sub-agents (automatic via PostToolUse)</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="ex">./.claude/hooks/log-subagent.sh</span> <span class="st">"&lt;agent-type&gt;"</span> <span class="st">"&lt;summary-of-findings&gt;"</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co"># Tasks (automatic via TodoWrite + PostToolUse)</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="ex">./.claude/hooks/log-task.sh</span> <span class="st">"&lt;status&gt;"</span> <span class="st">"&lt;task-description&gt;"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="id_3-workflow-pattern">3. Workflow Pattern<a class="anchor" aria-label="anchor" href="#id_3-workflow-pattern"></a></h4>
<pre><code>1. Check capsule ‚Üí See current context
2. Start task ‚Üí Use TodoWrite (auto-logged)
3. Work on task ‚Üí Read/edit files (auto-logged)
4. Use sub-agents ‚Üí Task tool (auto-logged)
5. Log discoveries ‚Üí Manual logging (you decide what's important)
6. Complete task ‚Üí Mark as completed (auto-logged via TodoWrite)</code></pre>
<p><strong>Auto-logging coverage: ~95%</strong> Only discoveries require manual logging - everything else is automatic!</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="id_-tool-enforcement-rules">‚ö° Tool Enforcement Rules<a class="anchor" aria-label="anchor" href="#id_-tool-enforcement-rules"></a></h2>
<p><tool-enforcement-rules priority="critical"><description> Super Claude Kit provides specialized tools that are FASTER and MORE ACCURATE than generic exploration. These rules are MANDATORY and enforced by PreToolUse hook. </description></tool-enforcement-rules></p>
<p><dependency-analysis category="always-use"><query type="what imports this file"><command>bash .claude/tools/query-deps/query-deps.sh &lt;file-path&gt;</command><use-case>Finding files that import/depend on a specific file</use-case></query></dependency-analysis></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="sc">&lt;</span>query type<span class="ot">=</span><span class="st">"who uses this function"</span><span class="sc">&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="er">&lt;</span>command<span class="sc">&gt;</span>bash .claude<span class="sc">/</span>tools<span class="sc">/</span>query<span class="sc">-</span>deps<span class="sc">/</span>query<span class="sc">-</span>deps.sh <span class="sc">&amp;</span>lt;file<span class="sc">-</span>path<span class="sc">&amp;</span>gt;<span class="sc">&lt;</span><span class="er">/</span>command<span class="sc">&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="er">&lt;</span>use<span class="sc">-</span>case<span class="sc">&gt;</span>Checking <span class="cf">if</span> a <span class="cf">function</span><span class="sc">/</span>export is used before deleting<span class="sc">&lt;</span><span class="er">/</span>use<span class="sc">-</span>case<span class="sc">&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="er">&lt;/</span>query<span class="sc">&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="er">&lt;</span>query type<span class="ot">=</span><span class="st">"what depends on X"</span><span class="sc">&gt;</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="er">&lt;</span>command<span class="sc">&gt;</span>bash .claude<span class="sc">/</span>tools<span class="sc">/</span>query<span class="sc">-</span>deps<span class="sc">/</span>query<span class="sc">-</span>deps.sh <span class="sc">&amp;</span>lt;file<span class="sc">-</span>path<span class="sc">&amp;</span>gt;<span class="sc">&lt;</span><span class="er">/</span>command<span class="sc">&gt;</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="er">&lt;</span>use<span class="sc">-</span>case<span class="sc">&gt;</span>Understanding dependency relationships<span class="sc">&lt;</span><span class="er">/</span>use<span class="sc">-</span>case<span class="sc">&gt;</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="er">&lt;/</span>query<span class="sc">&gt;</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="er">&lt;</span>query type<span class="ot">=</span><span class="st">"what would break if I change X"</span><span class="sc">&gt;</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  <span class="er">&lt;</span>command<span class="sc">&gt;</span>bash .claude<span class="sc">/</span>tools<span class="sc">/</span>impact<span class="sc">-</span>analysis<span class="sc">/</span>impact<span class="sc">-</span>analysis.sh <span class="sc">&amp;</span>lt;file<span class="sc">-</span>path<span class="sc">&amp;</span>gt;<span class="sc">&lt;</span><span class="er">/</span>command<span class="sc">&gt;</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>  <span class="er">&lt;</span>use<span class="sc">-</span>case<span class="sc">&gt;</span>Impact analysis before refactoring<span class="sc">&lt;</span><span class="er">/</span>use<span class="sc">-</span>case<span class="sc">&gt;</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>  <span class="er">&lt;</span>returns<span class="sc">&gt;</span>Direct dependents, transitive dependents, risk assessment<span class="sc">&lt;</span><span class="er">/</span>returns<span class="sc">&gt;</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="er">&lt;/</span>query<span class="sc">&gt;</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="er">&lt;</span>query type<span class="ot">=</span><span class="st">"circular dependencies"</span><span class="sc">&gt;</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>  <span class="er">&lt;</span>command<span class="sc">&gt;</span>bash .claude<span class="sc">/</span>tools<span class="sc">/</span>find<span class="sc">-</span>circular<span class="sc">/</span>find<span class="sc">-</span>circular.sh<span class="sc">&lt;</span><span class="er">/</span>command<span class="sc">&gt;</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>  <span class="er">&lt;</span>use<span class="sc">-</span>case<span class="sc">&gt;</span>Finding import cycles<span class="sc">&lt;</span><span class="er">/</span>use<span class="sc">-</span>case<span class="sc">&gt;</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>  <span class="er">&lt;</span>returns<span class="sc">&gt;</span>All circular dependency chains with fix suggestions<span class="sc">&lt;</span><span class="er">/</span>returns<span class="sc">&gt;</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="er">&lt;/</span>query<span class="sc">&gt;</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="er">&lt;</span>query type<span class="ot">=</span><span class="st">"dead code"</span><span class="sc">&gt;</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>  <span class="er">&lt;</span>command<span class="sc">&gt;</span>bash .claude<span class="sc">/</span>tools<span class="sc">/</span>find<span class="sc">-</span>dead<span class="sc">-</span>code<span class="sc">/</span>find<span class="sc">-</span>dead<span class="sc">-</span>code.sh<span class="sc">&lt;</span><span class="er">/</span>command<span class="sc">&gt;</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>  <span class="er">&lt;</span>use<span class="sc">-</span>case<span class="sc">&gt;</span>Finding unused<span class="sc">/</span>unreferenced files<span class="sc">&lt;</span><span class="er">/</span>use<span class="sc">-</span>case<span class="sc">&gt;</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>  <span class="er">&lt;</span>returns<span class="sc">&gt;</span>List of potentially unused files<span class="sc">&lt;</span><span class="er">/</span>returns<span class="sc">&gt;</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="er">&lt;/</span>query<span class="sc">&gt;</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="er">&lt;</span>never<span class="sc">-</span>use tool<span class="ot">=</span><span class="st">"Task"</span> subagent<span class="ot">=</span><span class="st">"Explore"</span> reason<span class="ot">=</span><span class="st">"inefficient-and-incomplete"</span><span class="sc">&gt;</span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a>  <span class="er">&lt;</span>reason priority<span class="ot">=</span><span class="st">"high"</span><span class="sc">&gt;</span>Slower <span class="sc">-</span> must read and parse files sequentially<span class="sc">&lt;</span><span class="er">/</span>reason<span class="sc">&gt;</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a>  <span class="er">&lt;</span>reason priority<span class="ot">=</span><span class="st">"high"</span><span class="sc">&gt;</span>Incomplete <span class="sc">-</span> may miss indirect dependencies<span class="sc">&lt;</span><span class="er">/</span>reason<span class="sc">&gt;</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a>  <span class="er">&lt;</span>reason priority<span class="ot">=</span><span class="st">"high"</span><span class="sc">&gt;</span>Expensive <span class="sc">-</span> high token usage <span class="cf">for</span> simple queries<span class="sc">&lt;</span><span class="er">/</span>reason<span class="sc">&gt;</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a>  <span class="er">&lt;</span>reason priority<span class="ot">=</span><span class="st">"critical"</span><span class="sc">&gt;</span>Cannot detect circular dependencies<span class="sc">&lt;</span><span class="er">/</span>reason<span class="sc">&gt;</span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="er">&lt;/</span>never<span class="sc">-</span>use<span class="sc">&gt;</span></span></code></pre></div>
<p></p>
<p><file-search category="always-use"><tool name="Glob" reason="direct-file-matching"><query type="find file by name"><pattern>**/<em>auth</em></pattern><use-case>Where is the auth file?</use-case></query></tool></file-search></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>  <span class="sc">&lt;</span>query type<span class="ot">=</span><span class="st">"find files by extension"</span><span class="sc">&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>    <span class="er">&lt;</span>pattern<span class="sc">&gt;</span><span class="er">**/*</span>.ts<span class="sc">&lt;</span><span class="er">/</span>pattern<span class="sc">&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    <span class="er">&lt;</span>use<span class="sc">-</span>case<span class="sc">&gt;</span>Find all TypeScript files<span class="sc">&lt;</span><span class="er">/</span>use<span class="sc">-</span>case<span class="sc">&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="er">&lt;/</span>query<span class="sc">&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="er">&lt;/</span>tool<span class="sc">&gt;</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="er">&lt;</span>never<span class="sc">-</span>use tool<span class="ot">=</span><span class="st">"Task"</span> subagent<span class="ot">=</span><span class="st">"Explore"</span> reason<span class="ot">=</span><span class="st">"inefficient"</span><span class="sc">&gt;</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  <span class="er">&lt;</span>alternative<span class="sc">&gt;</span>Use Glob tool <span class="cf">for</span> direct file name<span class="sc">/</span>pattern matching<span class="sc">&lt;</span><span class="er">/</span>alternative<span class="sc">&gt;</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="er">&lt;/</span>never<span class="sc">-</span>use<span class="sc">&gt;</span></span></code></pre></div>
<p></p>
<p><code-search category="always-use"><tool name="Grep" reason="fast-pattern-matching"><query type="find by keyword"><pattern>TODO</pattern><use-case>Find all TODO comments</use-case></query></tool></code-search></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>  <span class="sc">&lt;</span>query type<span class="ot">=</span><span class="st">"find definition"</span><span class="sc">&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>    <span class="er">&lt;</span>pattern<span class="sc">&gt;</span><span class="cf">function</span> X<span class="sc">&lt;</span><span class="er">/</span>pattern<span class="sc">&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>    <span class="er">&lt;</span>use<span class="sc">-</span>case<span class="sc">&gt;</span>Where is <span class="cf">function</span> X defined?<span class="sc">&lt;</span><span class="er">/</span>use<span class="sc">-</span>case<span class="sc">&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="er">&lt;/</span>query<span class="sc">&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="er">&lt;/</span>tool<span class="sc">&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="er">&lt;</span>never<span class="sc">-</span>use tool<span class="ot">=</span><span class="st">"Task"</span> subagent<span class="ot">=</span><span class="st">"Explore"</span> reason<span class="ot">=</span><span class="st">"inefficient"</span><span class="sc">&gt;</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="er">&lt;</span>alternative<span class="sc">&gt;</span>Use Grep tool <span class="cf">for</span> code pattern searches<span class="sc">&lt;</span><span class="er">/</span>alternative<span class="sc">&gt;</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="er">&lt;/</span>never<span class="sc">-</span>use<span class="sc">&gt;</span></span></code></pre></div>
<p></p>
<p><large-file-navigation category="use-for-structure" threshold="50KB"><tool name="progressive-reader" reason="file-navigation-and-structure-discovery"><description> Progressive-reader is a NAVIGATION TOOL for large files. Use it to understand file structure BEFORE reading, then read only what you need. </description></tool></large-file-navigation></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>  <span class="sc">&lt;</span>primary<span class="sc">-</span>value feature<span class="ot">=</span><span class="st">"--list"</span><span class="sc">&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>    The <span class="sc">--</span>list command shows file structure WITHOUT reading content<span class="sc">:</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    <span class="sc">-</span> Shows all functions<span class="sc">/</span>classes with their chunk numbers</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    <span class="sc">-</span> Each chunk has a summary of what it contains</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>    <span class="sc">-</span> <span class="er">~</span><span class="dv">500</span> tokens to see entire file <span class="fu">structure</span> (vs <span class="sc">~</span><span class="dv">48</span>,<span class="dv">000</span> <span class="cf">for</span> full read)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    <span class="sc">-</span> BETTER THAN GREP <span class="cf">for</span> understanding <span class="st">"what's in this file?"</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="sc">&lt;</span><span class="er">/</span>primary<span class="sc">-</span>value<span class="sc">&gt;</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  <span class="er">&lt;</span>workflow<span class="sc">&gt;</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>    <span class="er">&lt;</span>step1<span class="sc">&gt;</span>Discover structure<span class="sc">:</span> .claude<span class="sc">/</span>bin<span class="sc">/</span>progressive<span class="sc">-</span>reader <span class="sc">--</span>path <span class="sc">&amp;</span>lt;file<span class="sc">&amp;</span>gt; <span class="sc">--</span>list<span class="sc">&lt;</span><span class="er">/</span>step1<span class="sc">&gt;</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    <span class="er">&lt;</span>step2<span class="sc">&gt;</span>Find relevant chunks from <span class="cf">function</span><span class="sc">/</span>class names <span class="cf">in</span> the list<span class="sc">&lt;</span><span class="er">/</span>step2<span class="sc">&gt;</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    <span class="er">&lt;</span>step3<span class="sc">&gt;</span>Read specific chunk<span class="sc">:</span> .claude<span class="sc">/</span>bin<span class="sc">/</span>progressive<span class="sc">-</span>reader <span class="sc">--</span>path <span class="sc">&amp;</span>lt;file<span class="sc">&amp;</span>gt; <span class="sc">--</span>chunk N<span class="sc">&lt;</span><span class="er">/</span>step3<span class="sc">&gt;</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>    <span class="er">&lt;</span>step4<span class="sc">&gt;</span>Continue <span class="cf">if</span> needed<span class="sc">:</span> .claude<span class="sc">/</span>bin<span class="sc">/</span>progressive<span class="sc">-</span>reader <span class="sc">--</span>continue<span class="sc">-</span>file <span class="sc">/</span>tmp<span class="sc">/</span>continue.toon<span class="sc">&lt;</span><span class="er">/</span>step4<span class="sc">&gt;</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>  <span class="er">&lt;/</span>workflow<span class="sc">&gt;</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>  <span class="er">&lt;</span>when<span class="sc">-</span>to<span class="sc">-</span>use<span class="sc">&gt;</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>    <span class="er">&lt;</span>case<span class="sc">&gt;</span>Understanding file structure <span class="sc">-</span> <span class="st">"What functions are in this file?"</span><span class="sc">&lt;</span><span class="er">/</span>case<span class="sc">&gt;</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>    <span class="er">&lt;</span>case<span class="sc">&gt;</span>Finding specific functionality <span class="sc">-</span> <span class="st">"Which part handles authentication?"</span><span class="sc">&lt;</span><span class="er">/</span>case<span class="sc">&gt;</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>    <span class="er">&lt;</span>case<span class="sc">&gt;</span>Adding new code <span class="sc">-</span> <span class="st">"Show me similar functions so I can follow the pattern"</span><span class="sc">&lt;</span><span class="er">/</span>case<span class="sc">&gt;</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>    <span class="er">&lt;</span>case<span class="sc">&gt;</span>Targeted reading <span class="sc">-</span> <span class="st">"I need to understand just the login function"</span><span class="sc">&lt;</span><span class="er">/</span>case<span class="sc">&gt;</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>    <span class="er">&lt;</span>case<span class="sc">&gt;</span>Context<span class="sc">-</span>limited sessions <span class="sc">-</span> nearing token limits, need efficient reading<span class="sc">&lt;</span><span class="er">/</span>case<span class="sc">&gt;</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>  <span class="er">&lt;/</span>when<span class="sc">-</span>to<span class="sc">-</span>use<span class="sc">&gt;</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>  <span class="er">&lt;</span>when<span class="sc">-</span>grep<span class="sc">-</span>is<span class="sc">-</span>fine<span class="sc">&gt;</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>    <span class="er">&lt;</span>case<span class="sc">&gt;</span>Finding specific keyword occurrences<span class="sc">&lt;</span><span class="er">/</span>case<span class="sc">&gt;</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>    <span class="er">&lt;</span>case<span class="sc">&gt;</span>Searching <span class="cf">for</span> error messages or strings<span class="sc">&lt;</span><span class="er">/</span>case<span class="sc">&gt;</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>    <span class="er">&lt;</span>case<span class="sc">&gt;</span>Quick lookups where you know what you<span class="st">'re searching for&lt;/case&gt;</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="st">  &lt;/when-grep-is-fine&gt;</span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="st">  &lt;languages&gt;TypeScript, JavaScript, Python, Go (full AST parsing)&lt;/languages&gt;</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="st">  &lt;fallback&gt;Other languages use line-based chunking (still useful, less intelligent)&lt;/fallback&gt;</span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="st">  &lt;token-savings&gt;75-97% vs full file read&lt;/token-savings&gt;</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="st">&lt;/tool&gt;</span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="st">&lt;guidance for="Read-tool"&gt;</span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="st">  &lt;use-read-when&gt;File is under 50KB OR you genuinely need the entire file&lt;/use-read-when&gt;</span></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="st">  &lt;use-progressive-when&gt;File is large AND you need structure/specific sections&lt;/use-progressive-when&gt;</span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="st">  &lt;note&gt;PreToolUse hook will warn if you try to Read a file over 50KB&lt;/note&gt;</span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="st">&lt;/guidance&gt;</span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a><span class="st">&lt;mandatory-file-size-check priority="CRITICAL"&gt;</span></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="st">  &lt;rule&gt;BEFORE using Read tool, ALWAYS check file size first:&lt;/rule&gt;</span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a><span class="st">  &lt;check&gt;Run: wc -c &amp;lt;file&amp;gt; | awk '</span>{print <span class="fu">int</span>(<span class="sc">$</span><span class="dv">1</span><span class="sc">/</span><span class="dv">1024</span>)<span class="st">"KB"</span>}<span class="st">'&lt;/check&gt;</span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a><span class="st">  &lt;decision&gt;</span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a><span class="st">    &lt;if-under-50KB&gt;Use Read tool normally&lt;/if-under-50KB&gt;</span></span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a><span class="st">    &lt;if-over-50KB&gt;STOP. Use progressive-reader instead:&lt;/if-over-50KB&gt;</span></span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a><span class="st">  &lt;/decision&gt;</span></span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a></span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a><span class="st">  &lt;progressive-reader-command&gt;</span></span>
<span id="cb11-51"><a href="#cb11-51" tabindex="-1"></a><span class="st">    &lt;list&gt;.claude/bin/progressive-reader --path &amp;lt;file&amp;gt; --list&lt;/list&gt;</span></span>
<span id="cb11-52"><a href="#cb11-52" tabindex="-1"></a><span class="st">    &lt;read-chunk&gt;.claude/bin/progressive-reader --path &amp;lt;file&amp;gt; --chunk N&lt;/read-chunk&gt;</span></span>
<span id="cb11-53"><a href="#cb11-53" tabindex="-1"></a><span class="st">  &lt;/progressive-reader-command&gt;</span></span>
<span id="cb11-54"><a href="#cb11-54" tabindex="-1"></a></span>
<span id="cb11-55"><a href="#cb11-55" tabindex="-1"></a><span class="st">  &lt;why-this-matters&gt;</span></span>
<span id="cb11-56"><a href="#cb11-56" tabindex="-1"></a><span class="st">    Files over 50KB (~12,500+ tokens) cause MaxFileReadTokenExceededError.</span></span>
<span id="cb11-57"><a href="#cb11-57" tabindex="-1"></a><span class="st">    Each failed Read attempt wastes tokens. Check size FIRST.</span></span>
<span id="cb11-58"><a href="#cb11-58" tabindex="-1"></a><span class="st">  &lt;/why-this-matters&gt;</span></span>
<span id="cb11-59"><a href="#cb11-59" tabindex="-1"></a><span class="st">&lt;/mandatory-file-size-check&gt;</span></span>
<span id="cb11-60"><a href="#cb11-60" tabindex="-1"></a></span>
<span id="cb11-61"><a href="#cb11-61" tabindex="-1"></a><span class="st">&lt;error-recovery priority="CRITICAL"&gt;</span></span>
<span id="cb11-62"><a href="#cb11-62" tabindex="-1"></a><span class="st">  &lt;trigger&gt;MaxFileReadTokenExceededError&lt;/trigger&gt;</span></span>
<span id="cb11-63"><a href="#cb11-63" tabindex="-1"></a><span class="st">  &lt;action&gt;IMMEDIATELY stop using Read tool on this file&lt;/action&gt;</span></span>
<span id="cb11-64"><a href="#cb11-64" tabindex="-1"></a><span class="st">  &lt;solution&gt;Switch to: .claude/bin/progressive-reader --path &amp;lt;file&amp;gt; --list&lt;/solution&gt;</span></span>
<span id="cb11-65"><a href="#cb11-65" tabindex="-1"></a><span class="st">  &lt;do-not&gt;Do NOT retry Read with offset/limit - use progressive-reader&lt;/do-not&gt;</span></span>
<span id="cb11-66"><a href="#cb11-66" tabindex="-1"></a><span class="st">&lt;/error-recovery&gt;</span></span></code></pre></div>
<p></p>
<task-tool-allowed-uses><allowed priority="high"><use-case>Complex architectural questions requiring analysis</use-case><example>
How does the authentication system work?
</example><div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="sc">&lt;</span><span class="er">/</span>allowed<span class="sc">&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="er">&lt;</span>allowed priority<span class="ot">=</span><span class="st">"high"</span><span class="sc">&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="er">&lt;</span>use<span class="sc">-</span>case<span class="sc">&gt;</span>Implementation understanding<span class="sc">&lt;</span><span class="er">/</span>use<span class="sc">-</span>case<span class="sc">&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="er">&lt;</span>example<span class="sc">&gt;</span>How does X work internally?<span class="sc">&lt;</span><span class="er">/</span>example<span class="sc">&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="er">&lt;/</span>allowed<span class="sc">&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="er">&lt;</span>allowed priority<span class="ot">=</span><span class="st">"medium"</span><span class="sc">&gt;</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  <span class="er">&lt;</span>use<span class="sc">-</span>case<span class="sc">&gt;</span>Multi<span class="sc">-</span>file refactoring planning<span class="sc">&lt;</span><span class="er">/</span>use<span class="sc">-</span>case<span class="sc">&gt;</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>  <span class="er">&lt;</span>example<span class="sc">&gt;</span>Plan refactoring of auth module across files<span class="sc">&lt;</span><span class="er">/</span>example<span class="sc">&gt;</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="er">&lt;/</span>allowed<span class="sc">&gt;</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="er">&lt;</span>allowed priority<span class="ot">=</span><span class="st">"medium"</span><span class="sc">&gt;</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>  <span class="er">&lt;</span>use<span class="sc">-</span>case<span class="sc">&gt;</span>Design pattern identification<span class="sc">&lt;</span><span class="er">/</span>use<span class="sc">-</span>case<span class="sc">&gt;</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>  <span class="er">&lt;</span>example<span class="sc">&gt;</span>What patterns are used <span class="cf">in</span> this codebase?<span class="sc">&lt;</span><span class="er">/</span>example<span class="sc">&gt;</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="er">&lt;/</span>allowed<span class="sc">&gt;</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="er">&lt;</span>not<span class="sc">-</span>allowed<span class="sc">&gt;</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>  <span class="er">&lt;</span>forbidden<span class="sc">&gt;</span>Dependency lookups <span class="sc">-</span> use query<span class="sc">-</span>deps instead<span class="sc">&lt;</span><span class="er">/</span>forbidden<span class="sc">&gt;</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>  <span class="er">&lt;</span>forbidden<span class="sc">&gt;</span>File searches <span class="sc">-</span> use Glob instead<span class="sc">&lt;</span><span class="er">/</span>forbidden<span class="sc">&gt;</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>  <span class="er">&lt;</span>forbidden<span class="sc">&gt;</span>Code searches <span class="sc">-</span> use Grep instead<span class="sc">&lt;</span><span class="er">/</span>forbidden<span class="sc">&gt;</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="er">&lt;/</span>not<span class="sc">-</span>allowed<span class="sc">&gt;</span></span></code></pre></div>
<p></p></allowed></task-tool-allowed-uses><p><enforcement-mechanism><hook name="PreToolUse" action="intercept-and-warn"> PreToolUse hook intercepts Task tool calls for dependency queries and displays enforcement warnings. READ THESE WARNINGS - they indicate you are using the wrong tool. </hook></enforcement-mechanism></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="sc">&lt;</span>required<span class="sc">&gt;</span>true<span class="sc">&lt;</span><span class="er">/</span>required<span class="sc">&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="er">&lt;</span>bypass<span class="sc">&gt;</span>not<span class="sc">-</span>allowed<span class="sc">&lt;</span><span class="er">/</span>bypass<span class="sc">&gt;</span></span></code></pre></div>
<p> </p>
</div>
<div class="section level2">
<h2 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a></h2>
<p><best-practices priority="critical"><required-behaviors><behavior priority="high">Check capsule before redundant file reads</behavior><behavior priority="medium">Capture sub-agent findings immediately</behavior><behavior priority="medium">Note architectural discoveries as you learn</behavior><behavior priority="high">Reference capsule context in responses</behavior></required-behaviors></best-practices></p>
<p><forbidden-behaviors><forbidden priority="critical">Ignore the capsule (defeats the purpose!)</forbidden><forbidden priority="high">Re-read files shown in capsule (unless stale)</forbidden><forbidden priority="medium">Launch duplicate sub-agents for same task</forbidden></forbidden-behaviors></p>
</div>
<div class="section level2">
<h2 id="available-dependency-tools">Available Dependency Tools<a class="anchor" aria-label="anchor" href="#available-dependency-tools"></a></h2>
<p><dependency-tools><tool name="query-deps"><command>./.claude/tools/query-deps.sh &lt;file-path&gt;</command><when-to-use>Before deleting files, understanding dependencies</when-to-use></tool></dependency-tools></p>
<p><tool name="impact-analysis"><command>./.claude/tools/impact-analysis.sh &lt;file-path&gt;</command><when-to-use>Before refactoring, assessing change risk</when-to-use></tool></p>
<p><tool name="find-circular"><command>./.claude/tools/find-circular.sh</command><when-to-use>Debugging import failures, finding cycles</when-to-use></tool></p>
<p><tool name="find-dead-code"><command>./.claude/tools/find-dead-code.sh</command><when-to-use>Code cleanup, finding unused files</when-to-use></tool></p>
</div>
</div>


  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giampaolo Montaletti.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

