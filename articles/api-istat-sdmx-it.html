<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>API ISTAT SDMX: guida completa • istatlab</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="API ISTAT SDMX: guida completa">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">istatlab</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/getting-started.html">Get Started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>English</h6></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Italiano</h6></li>
    <li><a class="dropdown-item" href="../articles/getting-started-it.html">Introduzione a istatlab</a></li>
    <li><a class="dropdown-item" href="../articles/api-istat-sdmx-it.html">API ISTAT SDMX: guida completa</a></li>
    <li><a class="dropdown-item" href="../articles/gestione-dati-it.html">Gestione efficiente dei dati</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gmontaletti/istatlab" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>API ISTAT SDMX: guida completa</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gmontaletti/istatlab/blob/main/vignettes/api-istat-sdmx-it.Rmd" class="external-link"><code>vignettes/api-istat-sdmx-it.Rmd</code></a></small>
      <div class="d-none name"><code>api-istat-sdmx-it.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gmontaletti.github.io/istatlab/">istatlab</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduzione-allapi-sdmx">1. Introduzione all’API SDMX<a class="anchor" aria-label="anchor" href="#introduzione-allapi-sdmx"></a>
</h2>
<p>SDMX (Statistical Data and Metadata eXchange) è uno standard
internazionale ISO 17369 per lo scambio di dati e metadati statistici.
ISTAT implementa questo standard attraverso un servizio web RESTful
disponibile all’indirizzo <a href="https://esploradati.istat.it/SDMXWS" class="external-link uri">https://esploradati.istat.it/SDMXWS</a>.</p>
<p>Il pacchetto <code>istatlab</code> fornisce funzioni per accedere
all’API SDMX di ISTAT in modo efficiente. La configurazione del servizio
può essere ottenuta con <code><a href="../reference/get_istat_config.html">get_istat_config()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Ottenere la configurazione del servizio -----</span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_istat_config.html">get_istat_config</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Struttura della configurazione</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">config</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>La configurazione include:</p>
<ul>
<li>
<code>base_url</code>: URL base del servizio SDMX di ISTAT</li>
<li>
<code>endpoints</code>: endpoint disponibili per l’accesso ai dati e
ai metadati</li>
<li>
<code>defaults</code>: impostazioni predefinite (timeout, cache,
filtri)</li>
<li>
<code>dataset_categories</code>: categorie organizzate di
dataset</li>
<li>
<code>http</code>: configurazione delle richieste HTTP</li>
<li>
<code>cache</code>: impostazioni della cache locale</li>
</ul>
<p>Gli endpoint principali sono:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2. Visualizzare gli endpoint disponibili -----</span></span>
<span><span class="va">config</span><span class="op">$</span><span class="va">endpoints</span><span class="op">$</span><span class="va">rest_v1</span>          <span class="co"># API RESTful v1 (legacy)</span></span>
<span><span class="va">config</span><span class="op">$</span><span class="va">endpoints</span><span class="op">$</span><span class="va">rest_v2</span>          <span class="co"># API RESTful v2</span></span>
<span><span class="va">config</span><span class="op">$</span><span class="va">endpoints</span><span class="op">$</span><span class="va">data</span>             <span class="co"># Endpoint per il download dei dati</span></span>
<span><span class="va">config</span><span class="op">$</span><span class="va">endpoints</span><span class="op">$</span><span class="va">dataflow</span>         <span class="co"># Elenco dei dataset disponibili</span></span>
<span><span class="va">config</span><span class="op">$</span><span class="va">endpoints</span><span class="op">$</span><span class="va">datastructure</span>    <span class="co"># Struttura dei dataset e codelists</span></span>
<span><span class="va">config</span><span class="op">$</span><span class="va">endpoints</span><span class="op">$</span><span class="va">codelist</span>         <span class="co"># Definizioni delle codelists</span></span>
<span><span class="va">config</span><span class="op">$</span><span class="va">endpoints</span><span class="op">$</span><span class="va">registry</span>         <span class="co"># Endpoint registry SDMX v2.1</span></span>
<span><span class="va">config</span><span class="op">$</span><span class="va">endpoints</span><span class="op">$</span><span class="va">availableconstraint</span>  <span class="co"># Valori disponibili per le dimensioni</span></span></code></pre></div>
<p>Le impostazioni predefinite includono:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3. Impostazioni predefinite -----</span></span>
<span><span class="va">config</span><span class="op">$</span><span class="va">defaults</span><span class="op">$</span><span class="va">timeout</span>           <span class="co"># Timeout richieste HTTP (240 secondi)</span></span>
<span><span class="va">config</span><span class="op">$</span><span class="va">defaults</span><span class="op">$</span><span class="va">cache_days</span>        <span class="co"># Durata cache metadati (14 giorni)</span></span>
<span><span class="va">config</span><span class="op">$</span><span class="va">defaults</span><span class="op">$</span><span class="va">cache_dir</span>         <span class="co"># Directory cache locale ("meta")</span></span>
<span><span class="va">config</span><span class="op">$</span><span class="va">defaults</span><span class="op">$</span><span class="va">test_dataset</span>      <span class="co"># Dataset per test di connettività ("534_50")</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="struttura-degli-endpoint">2. Struttura degli endpoint<a class="anchor" aria-label="anchor" href="#struttura-degli-endpoint"></a>
</h2>
<p>Il pacchetto <code>istatlab</code> utilizza la funzione
<code><a href="../reference/build_istat_url.html">build_istat_url()</a></code> per costruire URL conformi allo standard
SDMX. Questa funzione gestisce automaticamente i parametri necessari per
ciascun endpoint.</p>
<div class="section level3">
<h3 id="endpoint-data">Endpoint data<a class="anchor" aria-label="anchor" href="#endpoint-data"></a>
</h3>
<p>L’endpoint data viene utilizzato per scaricare i dati da un dataset
specifico:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. URL per il download dei dati -----</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_istat_url.html">build_istat_url</a></span><span class="op">(</span></span>
<span>  endpoint <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  dataset_id <span class="op">=</span> <span class="st">"534_50"</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2020"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Con intervallo temporale completo</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_istat_url.html">build_istat_url</a></span><span class="op">(</span></span>
<span>  endpoint <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  dataset_id <span class="op">=</span> <span class="st">"534_50"</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2020"</span>,</span>
<span>  end_time <span class="op">=</span> <span class="st">"2023"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Con filtro personalizzato</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_istat_url.html">build_istat_url</a></span><span class="op">(</span></span>
<span>  endpoint <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  dataset_id <span class="op">=</span> <span class="st">"534_50"</span>,</span>
<span>  filter <span class="op">=</span> <span class="st">"A.IT"</span>,  <span class="co"># Frequenza annuale, Italia</span></span>
<span>  start_time <span class="op">=</span> <span class="st">"2020"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="endpoint-dataflow">Endpoint dataflow<a class="anchor" aria-label="anchor" href="#endpoint-dataflow"></a>
</h3>
<p>L’endpoint dataflow restituisce l’elenco di tutti i dataset
disponibili:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2. URL per l'elenco dei dataset -----</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_istat_url.html">build_istat_url</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">"dataflow"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="endpoint-datastructure">Endpoint datastructure<a class="anchor" aria-label="anchor" href="#endpoint-datastructure"></a>
</h3>
<p>L’endpoint datastructure fornisce la struttura di un dataset, incluse
le dimensioni e le codelists:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3. URL per la struttura di un dataset -----</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_istat_url.html">build_istat_url</a></span><span class="op">(</span></span>
<span>  endpoint <span class="op">=</span> <span class="st">"datastructure"</span>,</span>
<span>  dsd_ref <span class="op">=</span> <span class="st">"DSD_534_50"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="endpoint-codelist">Endpoint codelist<a class="anchor" aria-label="anchor" href="#endpoint-codelist"></a>
</h3>
<p>L’endpoint codelist restituisce le definizioni delle codelists:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 4. URL per le definizioni delle codelists -----</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_istat_url.html">build_istat_url</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">"codelist"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parametri-di-query">Parametri di query<a class="anchor" aria-label="anchor" href="#parametri-di-query"></a>
</h3>
<p>L’API SDMX supporta vari parametri di query per filtrare e limitare i
dati:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 5. Parametri di query avanzati -----</span></span>
<span></span>
<span><span class="co"># Limitare il numero di osservazioni</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_istat_url.html">build_istat_url</a></span><span class="op">(</span></span>
<span>  endpoint <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  dataset_id <span class="op">=</span> <span class="st">"534_50"</span>,</span>
<span>  lastNObservations <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filtrare per data di aggiornamento</span></span>
<span><span class="va">timestamp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2025-12-10 14:30:00"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_istat_url.html">build_istat_url</a></span><span class="op">(</span></span>
<span>  endpoint <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  dataset_id <span class="op">=</span> <span class="st">"534_50"</span>,</span>
<span>  updated_after <span class="op">=</span> <span class="va">timestamp</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="elenco-completo-degli-endpoint">Elenco completo degli endpoint<a class="anchor" aria-label="anchor" href="#elenco-completo-degli-endpoint"></a>
</h3>
<p>La funzione <code><a href="../reference/list_istat_endpoints.html">list_istat_endpoints()</a></code> restituisce
informazioni su tutti gli endpoint disponibili:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 6. Visualizzare tutti gli endpoint -----</span></span>
<span><span class="va">endpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/list_istat_endpoints.html">list_istat_endpoints</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">endpoints</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="verifica-della-connettività">3. Verifica della connettività<a class="anchor" aria-label="anchor" href="#verifica-della-connettivit%C3%A0"></a>
</h2>
<p>Prima di iniziare a scaricare dati, è opportuno verificare la
connettività al servizio SDMX. La funzione
<code><a href="../reference/test_endpoint_connectivity.html">test_endpoint_connectivity()</a></code> esegue test di connessione
agli endpoint.</p>
<div class="section level3">
<h3 id="test-di-un-singolo-endpoint">Test di un singolo endpoint<a class="anchor" aria-label="anchor" href="#test-di-un-singolo-endpoint"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Testare l'endpoint data -----</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/test_endpoint_connectivity.html">test_endpoint_connectivity</a></span><span class="op">(</span></span>
<span>  endpoints <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p>Il risultato include:</p>
<ul>
<li>
<code>endpoint</code>: nome dell’endpoint testato</li>
<li>
<code>url</code>: URL completo dell’endpoint</li>
<li>
<code>accessible</code>: logico che indica se l’endpoint è
raggiungibile</li>
<li>
<code>status_code</code>: codice HTTP della risposta</li>
<li>
<code>response_time</code>: tempo di risposta in secondi</li>
<li>
<code>error_message</code>: messaggio di errore eventuale</li>
</ul>
</div>
<div class="section level3">
<h3 id="test-di-tutti-gli-endpoint">Test di tutti gli endpoint<a class="anchor" aria-label="anchor" href="#test-di-tutti-gli-endpoint"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2. Testare tutti gli endpoint -----</span></span>
<span><span class="va">all_endpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"data"</span>,</span>
<span>  <span class="st">"dataflow"</span>,</span>
<span>  <span class="st">"datastructure"</span>,</span>
<span>  <span class="st">"codelist"</span>,</span>
<span>  <span class="st">"registry"</span>,</span>
<span>  <span class="st">"availableconstraint"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/test_endpoint_connectivity.html">test_endpoint_connectivity</a></span><span class="op">(</span></span>
<span>  endpoints <span class="op">=</span> <span class="va">all_endpoints</span>,</span>
<span>  timeout <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verificare quali endpoint sono accessibili</span></span>
<span><span class="va">accessible_endpoints</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[</span><span class="va">results</span><span class="op">$</span><span class="va">accessible</span> <span class="op">==</span> <span class="cn">TRUE</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">accessible_endpoints</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interpretazione-dei-risultati">Interpretazione dei risultati<a class="anchor" aria-label="anchor" href="#interpretazione-dei-risultati"></a>
</h3>
<p>I codici di stato HTTP più comuni sono:</p>
<ul>
<li>
<code>200</code>: richiesta riuscita</li>
<li>
<code>404</code>: risorsa non trovata</li>
<li>
<code>500</code>: errore interno del server</li>
<li>
<code>503</code>: servizio temporaneamente non disponibile</li>
<li>
<code>NA</code>: errore di connessione (timeout, rete,
firewall)</li>
</ul>
</div>
<div class="section level3">
<h3 id="risoluzione-dei-problemi">Risoluzione dei problemi<a class="anchor" aria-label="anchor" href="#risoluzione-dei-problemi"></a>
</h3>
<p>In caso di problemi di connettività:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3. Diagnostica della connettività -----</span></span>
<span></span>
<span><span class="co"># Verificare la connessione di rete</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">results</span><span class="op">$</span><span class="va">accessible</span><span class="op">[</span><span class="va">results</span><span class="op">$</span><span class="va">endpoint</span> <span class="op">==</span> <span class="st">"data"</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Possibili cause:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Connessione Internet assente\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Firewall aziendale che blocca l'accesso\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Configurazione proxy non corretta\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Servizio ISTAT temporaneamente non disponibile\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Aumentare il timeout per connessioni lente</span></span>
<span><span class="va">results_slow</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/test_endpoint_connectivity.html">test_endpoint_connectivity</a></span><span class="op">(</span></span>
<span>  endpoints <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  timeout <span class="op">=</span> <span class="fl">60</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="catalogo-dei-dataset">4. Catalogo dei dataset<a class="anchor" aria-label="anchor" href="#catalogo-dei-dataset"></a>
</h2>
<p>ISTAT pubblica centinaia di dataset attraverso l’API SDMX. Il
pacchetto <code>istatlab</code> fornisce funzioni per esplorare il
catalogo e trovare i dataset di interesse.</p>
<div class="section level3">
<h3 id="download-del-catalogo-completo">Download del catalogo completo<a class="anchor" aria-label="anchor" href="#download-del-catalogo-completo"></a>
</h3>
<p>La funzione <code><a href="../reference/download_metadata.html">download_metadata()</a></code> scarica l’elenco
completo dei dataset disponibili. I metadati vengono memorizzati nella
cache locale e aggiornati automaticamente ogni 14 giorni:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Scaricare il catalogo dei dataset -----</span></span>
<span><span class="va">catalogo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_metadata.html">download_metadata</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/setDT.html" class="external-link">setDT</a></span><span class="op">(</span><span class="va">catalogo</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualizzare la struttura</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">catalogo</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prime righe del catalogo</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">catalogo</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">id</span>, <span class="va">Name.it</span>, <span class="va">Name.en</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Il catalogo include:</p>
<ul>
<li>
<code>id</code>: identificatore univoco del dataset</li>
<li>
<code>Name.it</code>: nome del dataset in italiano</li>
<li>
<code>Name.en</code>: nome del dataset in inglese</li>
<li>Altri campi descrittivi</li>
</ul>
</div>
<div class="section level3">
<h3 id="cache-dei-metadati">Cache dei metadati<a class="anchor" aria-label="anchor" href="#cache-dei-metadati"></a>
</h3>
<p>I metadati vengono salvati nella directory <code>meta/</code> della
directory di lavoro:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2. Verifica della cache -----</span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_istat_config.html">get_istat_config</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># File della cache</span></span>
<span><span class="va">cache_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>  <span class="va">config</span><span class="op">$</span><span class="va">defaults</span><span class="op">$</span><span class="va">cache_dir</span>,</span>
<span>  <span class="va">config</span><span class="op">$</span><span class="va">cache</span><span class="op">$</span><span class="va">metadata_file</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cache_file</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># La cache viene aggiornata automaticamente dopo 14 giorni</span></span>
<span><span class="co"># Per forzare l'aggiornamento, eliminare il file della cache</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ricerca-per-parole-chiave">Ricerca per parole chiave<a class="anchor" aria-label="anchor" href="#ricerca-per-parole-chiave"></a>
</h3>
<p>La funzione <code><a href="../reference/search_dataflows.html">search_dataflows()</a></code> permette di cercare
dataset per parole chiave in italiano e inglese:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3. Ricerca di dataset -----</span></span>
<span></span>
<span><span class="co"># Ricerca in italiano</span></span>
<span><span class="va">occupati</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_dataflows.html">search_dataflows</a></span><span class="op">(</span><span class="st">"occupati"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">occupati</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">id</span>, <span class="va">Name.it</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ricerca in inglese</span></span>
<span><span class="va">vacancy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_dataflows.html">search_dataflows</a></span><span class="op">(</span><span class="st">"vacancy"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">vacancy</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">id</span>, <span class="va">Name.en</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ricerca multipla (OR logico)</span></span>
<span><span class="va">lavoro</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_dataflows.html">search_dataflows</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lavoro"</span>, <span class="st">"employment"</span>, <span class="st">"occupazione"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lavoro</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">id</span>, <span class="va">Name.it</span>, <span class="va">Name.en</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ricerca solo negli identificatori</span></span>
<span><span class="va">dataset_534</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_dataflows.html">search_dataflows</a></span><span class="op">(</span><span class="st">"534"</span>, fields <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dataset_534</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">id</span>, <span class="va">Name.it</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dataset-correlati">Dataset correlati<a class="anchor" aria-label="anchor" href="#dataset-correlati"></a>
</h3>
<p>La funzione <code><a href="../reference/expand_dataset_ids.html">expand_dataset_ids()</a></code> trova dataset correlati
(base e sotto-dataset):</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 4. Trovare dataset correlati -----</span></span>
<span><span class="va">correlati</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expand_dataset_ids.html">expand_dataset_ids</a></span><span class="op">(</span><span class="st">"150_908"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">correlati</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Esempio: 150_908, 150_915, 150_916 sono dataset correlati</span></span>
<span><span class="co"># sull'occupazione (mensile, trimestrale, annuale)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dataset-organizzati-per-categoria">Dataset organizzati per categoria<a class="anchor" aria-label="anchor" href="#dataset-organizzati-per-categoria"></a>
</h3>
<p>Il pacchetto organizza i dataset più comuni in categorie:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 5. Dataset per categoria -----</span></span>
<span></span>
<span><span class="co"># Tutte le categorie disponibili</span></span>
<span><span class="va">tutte_categorie</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_categorized_datasets.html">get_categorized_datasets</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tutte_categorie</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dataset di una categoria specifica</span></span>
<span><span class="va">employment_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dataset_category.html">get_dataset_category</a></span><span class="op">(</span><span class="st">"employment"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">employment_ids</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unemployment_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dataset_category.html">get_dataset_category</a></span><span class="op">(</span><span class="st">"unemployment"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">unemployment_ids</span><span class="op">)</span></span>
<span></span>
<span><span class="va">job_vacancies_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dataset_category.html">get_dataset_category</a></span><span class="op">(</span><span class="st">"job_vacancies"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">job_vacancies_ids</span><span class="op">)</span></span>
<span></span>
<span><span class="va">labour_force_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dataset_category.html">get_dataset_category</a></span><span class="op">(</span><span class="st">"labour_force"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">labour_force_ids</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="esplorare-la-struttura-di-un-dataset">5. Esplorare la struttura di un dataset<a class="anchor" aria-label="anchor" href="#esplorare-la-struttura-di-un-dataset"></a>
</h2>
<p>Prima di scaricare i dati, è utile conoscere la struttura del
dataset, le dimensioni disponibili e i valori delle codelists.</p>
<div class="section level3">
<h3 id="dimensioni-del-dataset">Dimensioni del dataset<a class="anchor" aria-label="anchor" href="#dimensioni-del-dataset"></a>
</h3>
<p>La funzione <code><a href="../reference/get_dataset_dimensions.html">get_dataset_dimensions()</a></code> restituisce i nomi
delle dimensioni:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Ottenere le dimensioni -----</span></span>
<span><span class="va">dimensioni</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dataset_dimensions.html">get_dataset_dimensions</a></span><span class="op">(</span><span class="st">"150_908"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dimensioni</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Esempio di output: FREQ, ITTER107, SESSO, ETA1, TIPO_DATO, etc.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="codelists">Codelists<a class="anchor" aria-label="anchor" href="#codelists"></a>
</h3>
<p>Le codelists contengono i valori possibili per ciascuna dimensione.
La funzione <code><a href="../reference/download_codelists.html">download_codelists()</a></code> scarica tutte le codelists
per un dataset:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2. Scaricare le codelists -----</span></span>
<span><span class="va">codelists</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_codelists.html">download_codelists</a></span><span class="op">(</span><span class="st">"150_908"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Struttura: lista nominata di data.table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">codelists</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Esempio: codelist ITTER107 (territorio)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">codelists</span><span class="op">[[</span><span class="st">"ITTER107"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Esempio: codelist SESSO (genere)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">codelists</span><span class="op">[[</span><span class="st">"SESSO"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Esempio: codelist ETA1 (classi di età)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">codelists</span><span class="op">[[</span><span class="st">"ETA1"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Ogni codelist è un data.table con colonne:</p>
<ul>
<li>
<code>id</code>: codice identificativo</li>
<li>
<code>name</code>: descrizione testuale</li>
</ul>
</div>
<div class="section level3">
<h3 id="funzioni-alternative-per-le-codelists">Funzioni alternative per le codelists<a class="anchor" aria-label="anchor" href="#funzioni-alternative-per-le-codelists"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3. Funzioni alternative -----</span></span>
<span></span>
<span><span class="co"># get_dataset_codelists: alias di download_codelists</span></span>
<span><span class="va">codelists_alt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dataset_codelists.html">get_dataset_codelists</a></span><span class="op">(</span><span class="st">"150_908"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">codelists</span>, <span class="va">codelists_alt</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ensure_codelists: verifica che le codelists siano in cache</span></span>
<span><span class="fu"><a href="../reference/ensure_codelists.html">ensure_codelists</a></span><span class="op">(</span><span class="st">"150_908"</span><span class="op">)</span></span>
<span><span class="co"># Questa funzione scarica le codelists solo se non sono già presenti</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dimensioni-dal-registry">Dimensioni dal registry<a class="anchor" aria-label="anchor" href="#dimensioni-dal-registry"></a>
</h3>
<p>La funzione <code><a href="../reference/fetch_registry_dimensions.html">fetch_registry_dimensions()</a></code> utilizza
l’endpoint registry per ottenere informazioni sulle dimensioni:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 4. Dimensioni dal registry API -----</span></span>
<span><span class="va">dim_registry</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetch_registry_dimensions.html">fetch_registry_dimensions</a></span><span class="op">(</span><span class="st">"150_908"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dim_registry</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Questa funzione è equivalente a get_dataset_dimensions</span></span>
<span><span class="co"># ma utilizza esplicitamente l'endpoint registry</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ispezionare-una-codelist">Ispezionare una codelist<a class="anchor" aria-label="anchor" href="#ispezionare-una-codelist"></a>
</h3>
<p>Una volta scaricate le codelists, è possibile ispezionarle nel
dettaglio:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 5. Ispezionare una codelist specifica -----</span></span>
<span><span class="va">codelists</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_codelists.html">download_codelists</a></span><span class="op">(</span><span class="st">"534_50"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Codelist ITTER107 (territorio)</span></span>
<span><span class="va">territorio</span> <span class="op">&lt;-</span> <span class="va">codelists</span><span class="op">[[</span><span class="st">"ITTER107"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">territorio</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filtrare per regioni</span></span>
<span><span class="va">regioni</span> <span class="op">&lt;-</span> <span class="va">territorio</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^IT[A-Z]"</span>, <span class="va">id</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">regioni</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Codelist FREQ (frequenza)</span></span>
<span><span class="va">frequenze</span> <span class="op">&lt;-</span> <span class="va">codelists</span><span class="op">[[</span><span class="st">"FREQ"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">frequenze</span><span class="op">)</span></span>
<span><span class="co"># M = mensile, Q = trimestrale, A = annuale</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="download-dei-dati">6. Download dei dati<a class="anchor" aria-label="anchor" href="#download-dei-dati"></a>
</h2>
<p>Il pacchetto <code>istatlab</code> fornisce funzioni flessibili per
il download dei dati dall’API SDMX di ISTAT.</p>
<div class="section level3">
<h3 id="download-di-base">Download di base<a class="anchor" aria-label="anchor" href="#download-di-base"></a>
</h3>
<p>La funzione <code><a href="../reference/download_istat_data.html">download_istat_data()</a></code> scarica i dati da un
dataset specificato:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Download di base -----</span></span>
<span><span class="va">dati</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data.html">download_istat_data</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"150_908"</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2023"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualizzare la struttura</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dati</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dati</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parametri-principali">Parametri principali<a class="anchor" aria-label="anchor" href="#parametri-principali"></a>
</h3>
<p>La funzione supporta numerosi parametri:</p>
<ul>
<li>
<code>dataset_id</code>: identificatore del dataset
(obbligatorio)</li>
<li>
<code>filter</code>: filtro dimensionale (default “ALL”)</li>
<li>
<code>start_time</code>: periodo iniziale</li>
<li>
<code>end_time</code>: periodo finale</li>
<li>
<code>incremental</code>: periodo iniziale per download
incrementale</li>
<li>
<code>timeout</code>: timeout della richiesta in secondi</li>
<li>
<code>verbose</code>: messaggi diagnostici</li>
<li>
<code>updated_after</code>: timestamp per rilevare
aggiornamenti</li>
<li>
<code>return_result</code>: restituire oggetto
<code>istat_result</code> completo</li>
<li>
<code>check_update</code>: verificare se ci sono aggiornamenti</li>
<li>
<code>cache_dir</code>: directory della cache</li>
<li>
<code>existing_data</code>: data.table esistente per merge</li>
</ul>
</div>
<div class="section level3">
<h3 id="download-con-intervallo-temporale">Download con intervallo temporale<a class="anchor" aria-label="anchor" href="#download-con-intervallo-temporale"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2. Download con intervallo temporale -----</span></span>
<span><span class="va">dati_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data.html">download_istat_data</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"150_908"</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2020"</span>,</span>
<span>  end_time <span class="op">=</span> <span class="st">"2023"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verifica dell'intervallo temporale</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">dati_range</span><span class="op">$</span><span class="va">TIME_PERIOD</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="download-incrementale">Download incrementale<a class="anchor" aria-label="anchor" href="#download-incrementale"></a>
</h3>
<p>Il parametro <code>incremental</code> permette di scaricare solo i
dati a partire da una certa data:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3. Download incrementale -----</span></span>
<span><span class="va">dati_incrementali</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data.html">download_istat_data</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"150_908"</span>,</span>
<span>  incremental <span class="op">=</span> <span class="st">"2024"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Questa modalità è utile per aggiornare dataset già scaricati</span></span>
<span><span class="co"># scaricando solo i nuovi dati</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="verifica-aggiornamenti">Verifica aggiornamenti<a class="anchor" aria-label="anchor" href="#verifica-aggiornamenti"></a>
</h3>
<p>Il parametro <code>check_update</code> verifica se ci sono
aggiornamenti disponibili prima di scaricare:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 4. Verifica aggiornamenti -----</span></span>
<span><span class="va">dati_update</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data.html">download_istat_data</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"534_50"</span>,</span>
<span>  check_update <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Se non ci sono aggiornamenti, la funzione restituisce NULL</span></span>
<span><span class="co"># senza scaricare i dati</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="merge-con-dati-esistenti">Merge con dati esistenti<a class="anchor" aria-label="anchor" href="#merge-con-dati-esistenti"></a>
</h3>
<p>Il parametro <code>existing_data</code> permette di unire i nuovi
dati con quelli già scaricati:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 5. Merge con dati esistenti -----</span></span>
<span></span>
<span><span class="co"># Prima scarico i dati fino al 2023</span></span>
<span><span class="va">dati_vecchi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data.html">download_istat_data</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"534_50"</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2020"</span>,</span>
<span>  end_time <span class="op">=</span> <span class="st">"2023"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Poi scarico i dati del 2024 e li unisco</span></span>
<span><span class="va">dati_completi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data.html">download_istat_data</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"534_50"</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2024"</span>,</span>
<span>  existing_data <span class="op">=</span> <span class="va">dati_vecchi</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># dati_completi contiene ora tutto il periodo 2020-2024</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="oggetto-risultato-completo">Oggetto risultato completo<a class="anchor" aria-label="anchor" href="#oggetto-risultato-completo"></a>
</h3>
<p>Il parametro <code>return_result = TRUE</code> restituisce un oggetto
<code>istat_result</code> con informazioni aggiuntive:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 6. Oggetto risultato completo -----</span></span>
<span><span class="va">risultato</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data.html">download_istat_data</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"534_50"</span>,</span>
<span>  return_result <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Struttura dell'oggetto istat_result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">risultato</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Componenti:</span></span>
<span><span class="va">risultato</span><span class="op">$</span><span class="va">data</span>          <span class="co"># data.table con i dati</span></span>
<span><span class="va">risultato</span><span class="op">$</span><span class="va">success</span>       <span class="co"># logico: download riuscito?</span></span>
<span><span class="va">risultato</span><span class="op">$</span><span class="va">exit_code</span>     <span class="co"># codice di uscita</span></span>
<span><span class="va">risultato</span><span class="op">$</span><span class="va">md5</span>           <span class="co"># hash MD5 dei dati</span></span>
<span><span class="va">risultato</span><span class="op">$</span><span class="va">message</span>       <span class="co"># messaggio descrittivo</span></span>
<span><span class="va">risultato</span><span class="op">$</span><span class="va">is_timeout</span>    <span class="co"># logico: timeout?</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="download-per-frequenza">Download per frequenza<a class="anchor" aria-label="anchor" href="#download-per-frequenza"></a>
</h3>
<p>La funzione <code><a href="../reference/download_istat_data_by_freq.html">download_istat_data_by_freq()</a></code> separa i dati
per frequenza temporale:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 7. Download per frequenza -----</span></span>
<span></span>
<span><span class="co"># Scaricare tutte le frequenze (separatamente)</span></span>
<span><span class="va">dati_freq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data_by_freq.html">download_istat_data_by_freq</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"151_914"</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2020"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Risultato: lista nominata con data.table per ogni frequenza</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dati_freq</span><span class="op">)</span>  <span class="co"># "M", "Q", "A" (mensile, trimestrale, annuale)</span></span>
<span></span>
<span><span class="co"># Accedere ai dati mensili</span></span>
<span><span class="va">dati_mensili</span> <span class="op">&lt;-</span> <span class="va">dati_freq</span><span class="op">[[</span><span class="st">"M"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dati_mensili</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Accedere ai dati trimestrali</span></span>
<span><span class="va">dati_trimestrali</span> <span class="op">&lt;-</span> <span class="va">dati_freq</span><span class="op">[[</span><span class="st">"Q"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dati_trimestrali</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Scaricare solo una frequenza specifica</span></span>
<span><span class="va">solo_trimestrale</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data_by_freq.html">download_istat_data_by_freq</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"151_914"</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2020"</span>,</span>
<span>  freq <span class="op">=</span> <span class="st">"Q"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="download-multiplo">Download multiplo<a class="anchor" aria-label="anchor" href="#download-multiplo"></a>
</h3>
<p>La funzione <code><a href="../reference/download_multiple_datasets.html">download_multiple_datasets()</a></code> permette di
scaricare più dataset in parallelo:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 8. Download multiplo -----</span></span>
<span></span>
<span><span class="co"># Scaricare più dataset contemporaneamente</span></span>
<span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"534_50"</span>, <span class="st">"534_51"</span>, <span class="st">"534_52"</span><span class="op">)</span></span>
<span><span class="va">dati_multipli</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_multiple_datasets.html">download_multiple_datasets</a></span><span class="op">(</span></span>
<span>  dataset_ids <span class="op">=</span> <span class="va">ids</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2020"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Risultato: lista nominata con un data.table per ogni dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dati_multipli</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Accedere ai dati di un dataset specifico</span></span>
<span><span class="va">dati_50</span> <span class="op">&lt;-</span> <span class="va">dati_multipli</span><span class="op">[[</span><span class="st">"534_50"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dati_50</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download multiplo con filtro di aggiornamento</span></span>
<span><span class="va">timestamp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2025-01-01 00:00:00"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span>
<span><span class="va">dati_aggiornati</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_multiple_datasets.html">download_multiple_datasets</a></span><span class="op">(</span></span>
<span>  dataset_ids <span class="op">=</span> <span class="va">ids</span>,</span>
<span>  updated_after <span class="op">=</span> <span class="va">timestamp</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Vengono scaricati solo i dataset aggiornati dopo il timestamp</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="elaborazione-dei-dati">7. Elaborazione dei dati<a class="anchor" aria-label="anchor" href="#elaborazione-dei-dati"></a>
</h2>
<p>Dopo il download, i dati vengono restituiti in formato grezzo con
codici dimensionali. Il pacchetto fornisce funzioni per trasformare i
codici in etichette leggibili.</p>
<div class="section level3">
<h3 id="applicazione-delle-etichette">Applicazione delle etichette<a class="anchor" aria-label="anchor" href="#applicazione-delle-etichette"></a>
</h3>
<p>La funzione <code><a href="../reference/apply_labels.html">apply_labels()</a></code> trasforma i codici
dimensionali in etichette descrittive:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Applicare le etichette -----</span></span>
<span></span>
<span><span class="co"># Scaricare dati grezzi</span></span>
<span><span class="va">dati_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data.html">download_istat_data</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"150_908"</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2023"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prima: colonne con codici (ITTER107, SESSO, ETA1, etc.)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dati_raw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Applicare le etichette</span></span>
<span><span class="va">dati_labeled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_labels.html">apply_labels</a></span><span class="op">(</span><span class="va">dati_raw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dopo: colonne con codici + colonne con etichette</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dati_labeled</span><span class="op">)</span></span></code></pre></div>
<p>La funzione <code><a href="../reference/apply_labels.html">apply_labels()</a></code> crea:</p>
<ul>
<li>Colonna <code>tempo</code>: data convertita da TIME_PERIOD</li>
<li>Colonna <code>valore</code>: valore numerico da OBS_VALUE</li>
<li>Colonne <code>*_label</code>: etichette descrittive per ogni
dimensione (es. <code>ITTER107_label</code>,
<code>SESSO_label</code>)</li>
<li>Mantiene tutte le colonne originali</li>
</ul>
</div>
<div class="section level3">
<h3 id="filtro-temporale">Filtro temporale<a class="anchor" aria-label="anchor" href="#filtro-temporale"></a>
</h3>
<p>La funzione <code><a href="../reference/filter_by_time.html">filter_by_time()</a></code> filtra i dati per
intervallo temporale:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2. Filtrare per periodo -----</span></span>
<span></span>
<span><span class="co"># Filtrare per anno</span></span>
<span><span class="va">dati_2024</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_by_time.html">filter_by_time</a></span><span class="op">(</span></span>
<span>  <span class="va">dati_labeled</span>,</span>
<span>  start_date <span class="op">=</span> <span class="st">"2024-01-01"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filtrare per intervallo</span></span>
<span><span class="va">dati_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_by_time.html">filter_by_time</a></span><span class="op">(</span></span>
<span>  <span class="va">dati_labeled</span>,</span>
<span>  start_date <span class="op">=</span> <span class="st">"2023-01-01"</span>,</span>
<span>  end_date <span class="op">=</span> <span class="st">"2023-12-31"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specificare la colonna temporale (se diversa da "tempo")</span></span>
<span><span class="va">dati_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_by_time.html">filter_by_time</a></span><span class="op">(</span></span>
<span>  <span class="va">dati_labeled</span>,</span>
<span>  start_date <span class="op">=</span> <span class="st">"2024-01-01"</span>,</span>
<span>  time_col <span class="op">=</span> <span class="st">"TIME_PERIOD"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="validazione-dei-dati">Validazione dei dati<a class="anchor" aria-label="anchor" href="#validazione-dei-dati"></a>
</h3>
<p>La funzione <code><a href="../reference/validate_istat_data.html">validate_istat_data()</a></code> verifica la qualità e
la struttura dei dati:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3. Validare i dati -----</span></span>
<span><span class="va">validazione</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate_istat_data.html">validate_istat_data</a></span><span class="op">(</span><span class="va">dati_labeled</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Restituisce un oggetto con informazioni diagnostiche</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">validazione</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verifica:</span></span>
<span><span class="co"># - Presenza di colonne obbligatorie</span></span>
<span><span class="co"># - Valori mancanti</span></span>
<span><span class="co"># - Duplicati</span></span>
<span><span class="co"># - Consistenza dei tipi di dato</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="normalizzazione-dei-nomi-delle-variabili">Normalizzazione dei nomi delle variabili<a class="anchor" aria-label="anchor" href="#normalizzazione-dei-nomi-delle-variabili"></a>
</h3>
<p>La funzione <code><a href="../reference/clean_variable_names.html">clean_variable_names()</a></code> normalizza i nomi
delle colonne:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 4. Normalizzare i nomi delle colonne -----</span></span>
<span><span class="va">dati_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_variable_names.html">clean_variable_names</a></span><span class="op">(</span><span class="va">dati_labeled</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rimuove caratteri speciali, converte in minuscolo,</span></span>
<span><span class="co"># sostituisce spazi con underscore</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dati_clean</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="formati-di-risposta-e-gestione-errori">8. Formati di risposta e gestione errori<a class="anchor" aria-label="anchor" href="#formati-di-risposta-e-gestione-errori"></a>
</h2>
<p>L’API SDMX di ISTAT supporta diversi formati di risposta. Il
pacchetto <code>istatlab</code> utilizza il formato CSV per
efficienza.</p>
<div class="section level3">
<h3 id="formato-csv">Formato CSV<a class="anchor" aria-label="anchor" href="#formato-csv"></a>
</h3>
<p>Il formato CSV viene richiesto tramite l’header HTTP:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Configurazione del formato -----</span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_istat_config.html">get_istat_config</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Header per richiesta CSV</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">config</span><span class="op">$</span><span class="va">http</span><span class="op">$</span><span class="va">accept_csv</span><span class="op">)</span></span>
<span><span class="co"># "application/vnd.sdmx.data+csv;version=1.0.0"</span></span>
<span></span>
<span><span class="co"># Header per richiesta XML (alternativa)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">config</span><span class="op">$</span><span class="va">http</span><span class="op">$</span><span class="va">accept_xml</span><span class="op">)</span></span>
<span><span class="co"># "application/vnd.sdmx.structurespecificdata+xml;version=2.1"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="oggetto-istat_result">Oggetto istat_result<a class="anchor" aria-label="anchor" href="#oggetto-istat_result"></a>
</h3>
<p>L’oggetto <code>istat_result</code> restituito da
<code>download_istat_data(return_result = TRUE)</code> contiene:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2. Componenti dell'oggetto istat_result -----</span></span>
<span><span class="va">risultato</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data.html">download_istat_data</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"534_50"</span>,</span>
<span>  return_result <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># data: data.table con i dati scaricati</span></span>
<span><span class="va">dati</span> <span class="op">&lt;-</span> <span class="va">risultato</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">dati</span><span class="op">)</span>  <span class="co"># "data.table" "data.frame"</span></span>
<span></span>
<span><span class="co"># success: logico che indica successo del download</span></span>
<span><span class="va">risultato</span><span class="op">$</span><span class="va">success</span>  <span class="co"># TRUE o FALSE</span></span>
<span></span>
<span><span class="co"># exit_code: codice numerico dello stato</span></span>
<span><span class="co"># 0 = successo, 1 = errore, 2 = timeout, 3 = nessun aggiornamento</span></span>
<span><span class="va">risultato</span><span class="op">$</span><span class="va">exit_code</span></span>
<span></span>
<span><span class="co"># md5: hash MD5 dei dati (per verifica integrità)</span></span>
<span><span class="va">risultato</span><span class="op">$</span><span class="va">md5</span></span>
<span></span>
<span><span class="co"># message: messaggio descrittivo</span></span>
<span><span class="va">risultato</span><span class="op">$</span><span class="va">message</span></span>
<span></span>
<span><span class="co"># is_timeout: logico che indica timeout</span></span>
<span><span class="va">risultato</span><span class="op">$</span><span class="va">is_timeout</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="codici-di-errore-http">Codici di errore HTTP<a class="anchor" aria-label="anchor" href="#codici-di-errore-http"></a>
</h3>
<p>I codici HTTP più comuni e il loro significato:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3. Interpretazione dei codici di stato -----</span></span>
<span></span>
<span><span class="co"># 200: richiesta riuscita</span></span>
<span><span class="co"># 404: dataset non trovato</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">risultato</span><span class="op">$</span><span class="va">exit_code</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Errore: verificare che il dataset_id sia corretto\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># 500: errore interno del server ISTAT</span></span>
<span><span class="co"># 503: servizio temporaneamente non disponibile</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">risultato</span><span class="op">$</span><span class="va">exit_code</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Errore del server: riprovare più tardi\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Timeout: richiesta scaduta</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">risultato</span><span class="op">$</span><span class="va">is_timeout</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Timeout: aumentare il parametro timeout\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gestione-degli-errori">Gestione degli errori<a class="anchor" aria-label="anchor" href="#gestione-degli-errori"></a>
</h3>
<p>Esempio di gestione errori con <code><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch()</a></code>:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 4. Gestione errori con tryCatch -----</span></span>
<span><span class="va">dati</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/download_istat_data.html">download_istat_data</a></span><span class="op">(</span></span>
<span>      dataset_id <span class="op">=</span> <span class="st">"150_908"</span>,</span>
<span>      start_time <span class="op">=</span> <span class="st">"2020"</span>,</span>
<span>      timeout <span class="op">=</span> <span class="fl">120</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Errore nel download:\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">conditionMessage</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  warning <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Avviso:\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">conditionMessage</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verificare il risultato</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">dati</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Download fallito\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Download riuscito:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dati</span><span class="op">)</span>, <span class="st">"righe\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gestione-programmatica-con-return_result">Gestione programmatica con return_result<a class="anchor" aria-label="anchor" href="#gestione-programmatica-con-return_result"></a>
</h3>
<p>Utilizzare <code>return_result = TRUE</code> per gestione
programmatica degli errori:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 5. Gestione programmatica -----</span></span>
<span><span class="va">risultato</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data.html">download_istat_data</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"150_908"</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2020"</span>,</span>
<span>  return_result <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verifica del successo</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">risultato</span><span class="op">$</span><span class="va">success</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Download riuscito</span></span>
<span>  <span class="va">dati</span> <span class="op">&lt;-</span> <span class="va">risultato</span><span class="op">$</span><span class="va">data</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Scaricate"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dati</span><span class="op">)</span>, <span class="st">"righe\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Hash MD5:"</span>, <span class="va">risultato</span><span class="op">$</span><span class="va">md5</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="co"># Download fallito</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Errore:"</span>, <span class="va">risultato</span><span class="op">$</span><span class="va">message</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Gestione per tipo di errore</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">risultato</span><span class="op">$</span><span class="va">is_timeout</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Suggerimento: aumentare il timeout\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">risultato</span><span class="op">$</span><span class="va">exit_code</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Nessun aggiornamento disponibile\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Verificare dataset_id e connessione\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="risorse-aggiuntive">9. Risorse aggiuntive<a class="anchor" aria-label="anchor" href="#risorse-aggiuntive"></a>
</h2>
<div class="section level3">
<h3 id="dataset-comuni">Dataset comuni<a class="anchor" aria-label="anchor" href="#dataset-comuni"></a>
</h3>
<p>Tabella dei dataset più utilizzati per il mercato del lavoro
italiano:</p>
<table class="table">
<thead><tr class="header">
<th>Dataset ID</th>
<th>Descrizione</th>
<th>Frequenza</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>150_908</td>
<td>Dati mensili sull’occupazione</td>
<td>Mensile</td>
</tr>
<tr class="even">
<td>150_915</td>
<td>Statistiche trimestrali sull’occupazione</td>
<td>Trimestrale</td>
</tr>
<tr class="odd">
<td>151_914</td>
<td>Tassi di disoccupazione</td>
<td>Mensile/Trimestrale</td>
</tr>
<tr class="even">
<td>534_50</td>
<td>Posti vacanti</td>
<td>Trimestrale</td>
</tr>
<tr class="odd">
<td>534_51</td>
<td>Posti vacanti per settore</td>
<td>Trimestrale</td>
</tr>
<tr class="even">
<td>534_52</td>
<td>Posti vacanti per regione</td>
<td>Trimestrale</td>
</tr>
<tr class="odd">
<td>152_914</td>
<td>Forze di lavoro</td>
<td>Mensile/Trimestrale</td>
</tr>
<tr class="even">
<td>152_915</td>
<td>Forze di lavoro per regione</td>
<td>Trimestrale</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="esempi-di-utilizzo">Esempi di utilizzo<a class="anchor" aria-label="anchor" href="#esempi-di-utilizzo"></a>
</h3>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Download dataset comuni -----</span></span>
<span></span>
<span><span class="co"># Occupazione mensile</span></span>
<span><span class="va">occupazione</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data.html">download_istat_data</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"150_908"</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2023"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dati_occ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_labels.html">apply_labels</a></span><span class="op">(</span><span class="va">occupazione</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Disoccupazione trimestrale</span></span>
<span><span class="va">disoccupazione</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data_by_freq.html">download_istat_data_by_freq</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"151_914"</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2023"</span>,</span>
<span>  freq <span class="op">=</span> <span class="st">"Q"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Posti vacanti</span></span>
<span><span class="va">vacancy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_istat_data.html">download_istat_data</a></span><span class="op">(</span></span>
<span>  dataset_id <span class="op">=</span> <span class="st">"534_50"</span>,</span>
<span>  start_time <span class="op">=</span> <span class="st">"2020"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dati_vac</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_labels.html">apply_labels</a></span><span class="op">(</span><span class="va">vacancy</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="link-utili">Link utili<a class="anchor" aria-label="anchor" href="#link-utili"></a>
</h3>
<ul>
<li>
<strong>Catalogo SDMX ISTAT</strong>: <a href="https://esploradati.istat.it/databrowser/" class="external-link uri">https://esploradati.istat.it/databrowser/</a>
</li>
<li>
<strong>Documentazione SDMX</strong>: <a href="https://sdmx.org/" class="external-link uri">https://sdmx.org/</a>
</li>
<li>
<strong>Standard ISO 17369</strong>: <a href="https://www.iso.org/standard/52500.html" class="external-link uri">https://www.iso.org/standard/52500.html</a>
</li>
<li>
<strong>Repository GitHub istatlab</strong>: <a href="https://github.com/gmontaletti/istatlab" class="external-link uri">https://github.com/gmontaletti/istatlab</a>
</li>
<li>
<strong>Segnalazione problemi</strong>: <a href="https://github.com/gmontaletti/istatlab/issues" class="external-link uri">https://github.com/gmontaletti/istatlab/issues</a>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="altre-vignette">Altre vignette<a class="anchor" aria-label="anchor" href="#altre-vignette"></a>
</h3>
<p>Per approfondire l’utilizzo del pacchetto, consultare le altre
vignette:</p>
<ul>
<li>
<code>getting-started-it</code>: guida introduttiva al pacchetto
istatlab</li>
<li>
<code>gestione-dati-it</code>: elaborazione e analisi dei dati
scaricati</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2. Aprire le vignette -----</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"getting-started-it"</span>, package <span class="op">=</span> <span class="st">"istatlab"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"gestione-dati-it"</span>, package <span class="op">=</span> <span class="st">"istatlab"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="supporto">Supporto<a class="anchor" aria-label="anchor" href="#supporto"></a>
</h3>
<p>Per domande, suggerimenti o segnalazioni:</p>
<ul>
<li>Email: <a href="mailto:giampaolo.montaletti@gmail.com" class="email">giampaolo.montaletti@gmail.com</a>
</li>
<li>GitHub Issues: <a href="https://github.com/gmontaletti/istatlab/issues" class="external-link uri">https://github.com/gmontaletti/istatlab/issues</a>
</li>
<li>ORCID: <a href="https://orcid.org/0009-0002-5327-1122" class="external-link uri">https://orcid.org/0009-0002-5327-1122</a>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giampaolo Montaletti.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
